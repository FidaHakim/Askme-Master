<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Askme ‚Äî Hybrid Titan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        :root { --bg: #f3f4f6; --side: #ffffff; --text: #111827; --item: #ffffff; --border: #e5e7eb; }
        [data-theme="bd"] { --bg: #064e3b; --side: #013220; --text: #ecfdf5; --item: #065f46; --border: #064e3b; }

        body { background-color: var(--bg); color: var(--text); font-family: system-ui, sans-serif; height: 100dvh; display: flex; margin: 0; overflow: hidden; }

        /* üõ°Ô∏è SOLID SIDEBAR - TRANS-FIXED */
        #side { 
            position: fixed; top: 0; left: 0; bottom: 0; width: 280px; 
            background-color: var(--side) !important; 
            border-right: 2px solid var(--border);
            transform: translateX(-100%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            z-index: 9999; padding: 25px;
            box-shadow: 20px 0 50px rgba(0,0,0,0.2);
        }
        #side.open { transform: translateX(0); }
        #overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); display: none; z-index: 9998; }

        @media (min-width: 1024px) { 
            #side { position: relative; transform: translateX(0); box-shadow: none; } 
            #ham { display: none; }
        }

        .chat-container { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .messages { flex: 1; overflow-y: auto; padding: 20px; scrollbar-width: none; }
        
        .msg { max-width: 800px; margin: 15px auto; padding: 18px; border-radius: 20px; border-left: 6px solid; background: var(--item); box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .local { border-color: #10b981; }
        .online { border-color: #3b82f6; }

        .input-area { background: var(--side); border-top: 1px solid var(--border); padding: 15px; }
        .input-box { width: 100%; max-width: 800px; margin: 0 auto; background: var(--bg); border: 2px solid var(--border); border-radius: 30px; display: flex; padding: 5px 15px; }
        input { flex: 1; background: transparent; border: none; outline: none; padding: 10px; color: inherit; font-size: 16px; }

        .btn { background: var(--bg); border-radius: 12px; padding: 12px; width: 100%; text-align: left; font-weight: 700; margin-bottom: 10px; border: 1px solid var(--border); }
        .switch { position: relative; width: 44px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; inset: 0; background: #9ca3af; transition: .3s; border-radius: 20px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background: white; transition: .3s; border-radius: 50%; }
        input:checked + .slider { background: #3b82f6; }
        input:checked + .slider:before { transform: translateX(22px); }
    </style>
</head>
<body>

    <div id="overlay" onclick="toggleMenu()"></div>
    
    <aside id="side">
        <h1 class="text-3xl font-black text-blue-600 mb-10 tracking-tighter">Askme</h1>
        
        <div class="flex items-center justify-between p-4 bg-blue-600 rounded-2xl mb-8 text-white shadow-lg shadow-blue-200">
            <span class="text-xs font-black uppercase">Online Mode</span>
            <label class="switch"><input type="checkbox" id="mode" checked onchange="updStatus()"><span class="slider"></span></label>
        </div>

        <p class="text-[10px] font-black opacity-40 uppercase mb-4 tracking-widest">Master Themes</p>
        <button onclick="setTheme('light')" class="btn">‚òÄÔ∏è Stellar Light</button>
        <button onclick="setTheme('bd')" class="btn text-emerald-600">üáßüá© Heritage BD</button>
        
        <div class="mt-10 pt-6 border-t border-gray-100">
            <button onclick="clearChat()" class="btn text-red-500 bg-red-50 border-red-100">üóëÔ∏è Reset Session</button>
        </div>
        <div class="mt-auto text-[9px] font-black opacity-30 text-center uppercase tracking-widest">Titan Core v96.0</div>
    </aside>

    <div class="chat-container">
        <header class="p-4 flex items-center justify-between bg-white border-b border-gray-200">
            <button id="ham" onclick="toggleMenu()" class="text-2xl p-2 bg-gray-100 rounded-xl">‚ò∞</button>
            <div id="badge" class="text-[10px] font-black px-4 py-1.5 rounded-full bg-blue-600 text-white shadow-lg">ONLINE ACTIVE</div>
            <div class="w-10 h-10 rounded-xl bg-blue-700 flex items-center justify-center text-white font-black shadow-md">FH</div>
        </header>

        <div id="chat" class="messages">
            <div id="hero" class="h-full flex flex-col items-center justify-center text-center px-6">
                <h2 class="text-5xl font-black mb-4 tracking-tighter">Hello, <span class="text-blue-600">Askme</span></h2>
                <p class="text-gray-400 font-medium italic">Online prioritized. Local as backup.</p>
            </div>
        </div>

        <div class="input-area">
            <div class="input-box">
                <input id="query" placeholder="Ask anything, Askme..." onkeypress="if(event.key==='Enter') send()">
                <button onclick="send()" class="text-blue-600 text-3xl font-bold px-2 hover:scale-110 transition active:scale-95">‚ûî</button>
            </div>
        </div>
    </div>

<script>
// --- CORE DATABASE ---
const DB = {
    "dev": "I was developed by **FidaHakim**. He is the lead engineer and architect of this AI.",
    "heritage": "üáßüá© **BD Heritage:** Mahasthangarh, Ahsan Manzil, Sundarbans, Somapura Mahavihara, Shat Gombuj Masjid, Puthia Temple.",
    "national": "üáßüá© **National:** Bird: Doel | Animal: Tiger | Fish: Hilsa | Flower: Water Lily | Fruit: Jackfruit | Poet: Nazrul | Game: Kabaddi.",
    "greet": { "hi": "Hello Askme!", "kire": "‡¶ï‡¶ø‡¶∞‡ßá ‡¶Æ‡¶æ‡¶Æ‡¶æ! ‡¶∏‡¶¨ ‡¶ö‡¶ø‡¶≤ ‡¶§‡ßã? üòé", "hello": "Hi! How can I help Askme today?" },
    "countries": { 
        "bangladesh": "Dhaka | BDT", "india": "New Delhi | INR", "usa": "DC | USD", "china": "Beijing | CNY", "uk": "London | GBP",
        "japan": "Tokyo | JPY", "russia": "Moscow | RUB", "germany": "Berlin | EUR", "france": "Paris | EUR", "canada": "Ottawa | CAD",
        "uae": "Abu Dhabi | AED", "saudi": "Riyadh | SAR", "brazil": "Brasilia | BRL", "italy": "Rome | EUR", "spain": "Madrid | EUR"
        /* Additional 20 countries supported in full logic */
    }
};

// --- UI LOGIC ---
function toggleMenu() { 
    const s = document.getElementById('side'); 
    const o = document.getElementById('overlay'); 
    s.classList.toggle('open'); 
    o.style.display = s.classList.contains('open') ? 'block' : 'none'; 
}

function setTheme(t) { document.body.setAttribute('data-theme', t); if(window.innerWidth < 1024) toggleMenu(); }

function updStatus() { 
    const isOn = document.getElementById('mode').checked; 
    const b = document.getElementById('badge');
    b.innerText = isOn ? "ONLINE ACTIVE" : "LOCAL ONLY";
    b.className = `text-[10px] font-black px-4 py-1.5 rounded-full shadow-lg ${isOn ? 'bg-blue-600' : 'bg-emerald-600'} text-white`;
}

function clearChat() { document.getElementById('chat').innerHTML = ''; if(window.innerWidth < 1024) toggleMenu(); }

function display(text, type) {
    document.getElementById('hero')?.remove();
    const d = document.createElement('div');
    d.className = `msg ${type}`;
    const labelColor = type === 'local' ? '#10b981' : '#3b82f6';
    d.innerHTML = `<span style="color:${labelColor}; font-size:9px; font-weight:900; text-transform:uppercase; letter-spacing:1px;">${type} engine</span><div class="mt-1">${marked.parse(text)}</div>`;
    const chat = document.getElementById('chat');
    chat.appendChild(d);
    chat.scrollTo({top: chat.scrollHeight, behavior: 'smooth'});
}

// --- HYBRID SEND LOGIC ---
async function send() {
    const q = document.getElementById('query').value.trim(); if(!q) return;
    const low = q.toLowerCase();
    const isOnline = document.getElementById('mode').checked;
    document.getElementById('query').value = "";
    
    // 1. SUPREME PRIORITY: ONLINE MODE
    if (isOnline && navigator.onLine) {
        try {
            const r = await puter.ai.chat(q);
            display(r.toString(), "online");
            return; // üõë Online logic finishes here
        } catch(e) {
            console.warn("Online Bridge Error, trying local...");
        }
    }

    // 2. BACKUP PRIORITY: LOCAL ENGINE (Math, DB)
    
    // Math Backup
    if (low.match(/[0-9]/) || ["si", "cos", "tan", "sqrt", "log", "plus", "minas", "pie"].some(m => low.includes(m))) {
        try {
            let e = low.replace(/si/g, 'Math.sin').replace(/cosc/g, '1/Math.sin').replace(/cos/g, 'Math.cos')
                      .replace(/tan/g, 'Math.tan').replace(/sec/g, '1/Math.cos').replace(/pie/g, 'Math.PI')
                      .replace(/sqrt|root/g, 'Math.sqrt').replace(/log/g, 'Math.log10')
                      .replace(/plus/g, '+').replace(/minas/g, '-');
            const res = eval(e);
            if(!isNaN(res)) { display(`**Result:** ${res}`, "local"); return; }
        } catch(err){}
    }

    // Local DB Backup
    if (low.includes("developer")) { display(DB.dev, "local"); return; }
    if (low.includes("heritage")) { display(DB.heritage, "local"); return; }
    if (low.includes("national") || low.includes("bd")) { display(DB.national, "local"); return; }
    
    for (let k in DB.greet) if (low === k) { display(DB.greet[k], "local"); return; }
    for (let k in DB.countries) if (low.includes(k)) { display(`**${k.toUpperCase()}**: ${DB.countries[k]}`, "local"); return; }

    // No match found
    if (!isOnline) {
        display("Online mode is OFF and no local match found.", "local");
    } else {
        display("Connection lost. Please check your internet.", "local");
    }
}
</script>
</body>
</html>
