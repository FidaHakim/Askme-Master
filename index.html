<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Askme ‚Äî Infinity Singularity</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://js.puter.com/v2/"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        :root { --bg: #ffffff; --surface: #f0f4f9; }
        body { font-family: 'Outfit', sans-serif; background: var(--bg); color: #1f1f1f; height: 100dvh; display: flex; flex-direction: column; overflow: hidden; margin: 0; }
        
        #chat-container { scroll-behavior: smooth; overflow-y: auto; scrollbar-width: none; }
        #chat-container::-webkit-scrollbar { display: none; }

        .gradient-text { background: linear-gradient(74deg, #4285f4 0%, #9b72cb 19%, #d96570 73%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        /* Premium Message Styles */
        .msg-user { background: #f0f4f9; border-radius: 1.5rem; padding: 12px 22px; align-self: flex-end; max-width: 85%; margin-bottom: 24px; font-size: 0.95rem; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .msg-ai { width: 100%; display: flex; gap: 16px; margin-bottom: 32px; animation: fadeIn 0.5s ease; }
        .ai-icon { width: 32px; height: 32px; border-radius: 50%; background: linear-gradient(135deg, #4285f4, #9b72cb, #d96570); flex-shrink: 0; }
        
        /* Floating Input Bar */
        .input-pill { background: #f0f4f9; border-radius: 32px; padding: 8px 18px; display: flex; align-items: center; gap: 12px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .input-pill:focus-within { background: #e8eaed; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }

        /* Animation & Sidebar */
        #sidebar { transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); z-index: 100; box-shadow: 5px 0 15px rgba(0,0,0,0.05); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Switch Animation */
        .switch { position: relative; width: 44px; height: 22px; cursor: pointer; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-color: #cbd5e1; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #2563eb; }
        input:checked + .slider:before { transform: translateX(22px); }

        pre { background: #1e1e1e !important; color: #e0e0e0; padding: 16px; border-radius: 12px; overflow-x: auto; margin: 10px 0; border: 1px solid #333; }
        code { font-family: 'Consolas', monospace; }
        .prose strong { color: #2563eb; font-weight: 600; }
    </style>
</head>
<body>

<div id="overlay" class="fixed inset-0 hidden bg-black/20 backdrop-blur-sm z-50" onclick="UI.toggleMenu()"></div>

<aside id="sidebar" class="fixed inset-y-0 left-0 w-80 bg-[#fbfdff] transform -translate-x-full flex flex-col z-[60]">
    <div class="p-5 flex items-center justify-between border-b border-gray-100">
        <span class="font-bold text-lg text-gray-700">Infinity Core</span>
        <button onclick="UI.toggleMenu()" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-red-50 text-gray-400 hover:text-red-500 transition">
            ‚úñ
        </button>
    </div>
    
    <div class="p-4">
        <button onclick="UI.newChat()" class="flex items-center gap-3 px-4 py-3 bg-blue-600 text-white shadow-lg shadow-blue-200 rounded-xl font-medium text-sm hover:bg-blue-700 transition w-full">
            <span>+</span> New Context
        </button>
    </div>
    
    <div class="flex-1 px-4 overflow-y-auto">
        <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mt-4 mb-2">Capabilities</p>
        <ul class="text-sm text-gray-600 space-y-2">
            <li class="p-2.5 hover:bg-blue-50 rounded-lg cursor-default flex items-center gap-2">üåç <span>210+ Countries</span></li>
            <li class="p-2.5 hover:bg-blue-50 rounded-lg cursor-default flex items-center gap-2">üî¢ <span>Modulus & Trig</span></li>
            <li class="p-2.5 hover:bg-blue-50 rounded-lg cursor-default flex items-center gap-2">üíª <span>Multi-Lang Code</span></li>
        </ul>
    </div>

    <div class="p-6 border-t border-gray-100 bg-gray-50/80">
        <div class="flex items-center justify-between mb-4">
            <span class="text-xs font-bold text-gray-500">Neural Sync</span>
            <label class="switch">
                <input type="checkbox" id="mode" checked>
                <span class="slider"></span>
            </label>
        </div>
        <p class="text-[9px] text-center text-gray-400 font-black uppercase tracking-[2px]">Askme V2.0</p>
    </div>
</aside>

<div class="flex-1 flex flex-col h-full overflow-hidden">
    <header class="h-16 flex items-center justify-between px-4 sm:px-6 shrink-0 bg-white/80 backdrop-blur-md sticky top-0 z-40">
        <button onclick="UI.toggleMenu()" class="p-2 hover:bg-gray-100 rounded-full transition text-gray-600">‚ò∞</button>
        <div class="flex items-center gap-1">
            <span class="text-xl font-medium text-gray-700 tracking-tight">Askme</span>
            <span class="text-[9px] bg-blue-600 text-white px-1.5 py-0.5 rounded font-black">INFINITY</span>
        </div>
        <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-blue-500 to-fuchsia-500 shadow-sm"></div>
    </header>

    <main id="chat-container" class="flex-1 flex flex-col p-4 sm:px-20 md:px-40 lg:px-64">
        <div id="hero" class="mt-20">
            <h1 class="text-4xl sm:text-5xl font-medium mb-3"><span class="gradient-text">Hello, Askme</span></h1>
            <p class="text-2xl sm:text-3xl text-gray-300 font-medium">Global intelligence. Offline.</p>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-12">
                <div onclick="UI.fill('Time in Slovakia')" class="p-5 bg-[#f0f4f9] rounded-2xl cursor-pointer hover:bg-blue-50 transition border border-transparent hover:border-blue-100 group">
                    <p class="text-xs font-bold text-gray-400 uppercase mb-1 group-hover:text-blue-500">Geography</p>
                    <p class="text-sm text-gray-700">Explore 210 countries & timezones.</p>
                </div>
                <div onclick="UI.fill('Write a Python loop')" class="p-5 bg-[#f0f4f9] rounded-2xl cursor-pointer hover:bg-blue-50 transition border border-transparent hover:border-blue-100 group">
                    <p class="text-xs font-bold text-gray-400 uppercase mb-1 group-hover:text-blue-500">Coding</p>
                    <p class="text-sm text-gray-700">Generate snippets in Python, JS, C++.</p>
                </div>
            </div>
        </div>
        <div id="messages" class="flex flex-col pb-4"></div>
    </main>

    <div class="p-4 sm:px-20 md:px-40 lg:px-64 bg-white shrink-0 pb-6">
        <div class="input-pill">
            <button onclick="document.getElementById('f-inp').click()" class="text-gray-400 hover:text-blue-600 transition">üìé</button>
            <input type="file" id="f-inp" class="hidden" onchange="App.handleFile(this)">
            <input id="query" type="text" class="flex-1 bg-transparent border-none outline-none py-2 text-gray-800" placeholder="Ask math, code, or countries..." onkeypress="if(event.key==='Enter') App.run()">
            <button onclick="App.run()" class="text-blue-600 font-bold hover:scale-110 transition p-1">‚ûî</button>
        </div>
    </div>
</div>

<script>
/**
 * üß† INFINITY LOGIC CORE V2
 * Includes 210 Countries, Advanced Coding, and Modulo Math
 */
const LogicCore = {
    // Extensive Database for 210 Countries/Territories
    db: {
        countries: {
            "afghanistan": ["Kabul", "AFN", "Asia/Kabul"], "albania": ["Tirana", "ALL", "Europe/Tirane"], "algeria": ["Algiers", "DZD", "Africa/Algiers"],
            "andorra": ["Andorra la Vella", "EUR", "Europe/Andorra"], "angola": ["Luanda", "AOA", "Africa/Luanda"], "argentina": ["Buenos Aires", "ARS", "America/Argentina/Buenos_Aires"],
            "armenia": ["Yerevan", "AMD", "Asia/Yerevan"], "australia": ["Canberra", "AUD", "Australia/Sydney"], "austria": ["Vienna", "EUR", "Europe/Vienna"],
            "azerbaijan": ["Baku", "AZN", "Asia/Baku"], "bahamas": ["Nassau", "BSD", "America/Nassau"], "bahrain": ["Manama", "BHD", "Asia/Bahrain"],
            "bangladesh": ["Dhaka", "BDT", "Asia/Dhaka"], "barbados": ["Bridgetown", "BBD", "America/Barbados"], "belarus": ["Minsk", "BYN", "Europe/Minsk"],
            "belgium": ["Brussels", "EUR", "Europe/Brussels"], "belize": ["Belmopan", "BZD", "America/Belize"], "benin": ["Porto-Novo", "XOF", "Africa/Porto-Novo"],
            "bhutan": ["Thimphu", "BTN", "Asia/Thimphu"], "bolivia": ["Sucre", "BOB", "America/La_Paz"], "bosnia": ["Sarajevo", "BAM", "Europe/Sarajevo"],
            "botswana": ["Gaborone", "BWP", "Africa/Gaborone"], "brazil": ["Brasilia", "BRL", "America/Sao_Paulo"], "brunei": ["Bandar Seri Begawan", "BND", "Asia/Brunei"],
            "bulgaria": ["Sofia", "BGN", "Europe/Sofia"], "burkina faso": ["Ouagadougou", "XOF", "Africa/Ouagadougou"], "burundi": ["Gitega", "BIF", "Africa/Bujumbura"],
            "cambodia": ["Phnom Penh", "KHR", "Asia/Phnom_Penh"], "cameroon": ["Yaounde", "XAF", "Africa/Douala"], "canada": ["Ottawa", "CAD", "America/Toronto"],
            "chile": ["Santiago", "CLP", "America/Santiago"], "china": ["Beijing", "CNY", "Asia/Shanghai"], "colombia": ["Bogota", "COP", "America/Bogota"],
            "costa rica": ["San Jose", "CRC", "America/Costa_Rica"], "croatia": ["Zagreb", "EUR", "Europe/Zagreb"], "cuba": ["Havana", "CUP", "America/Havana"],
            "cyprus": ["Nicosia", "EUR", "Asia/Nicosia"], "czechia": ["Prague", "CZK", "Europe/Prague"], "denmark": ["Copenhagen", "DKK", "Europe/Copenhagen"],
            "djibouti": ["Djibouti", "DJF", "Africa/Djibouti"], "dominica": ["Roseau", "XCD", "America/Dominica"], "ecuador": ["Quito", "USD", "America/Guayaquil"],
            "egypt": ["Cairo", "EGP", "Africa/Cairo"], "estonia": ["Tallinn", "EUR", "Europe/Tallinn"], "ethiopia": ["Addis Ababa", "ETB", "Africa/Addis_Ababa"],
            "fiji": ["Suva", "FJD", "Pacific/Fiji"], "finland": ["Helsinki", "EUR", "Europe/Helsinki"], "france": ["Paris", "EUR", "Europe/Paris"],
            "gabon": ["Libreville", "XAF", "Africa/Libreville"], "gambia": ["Banjul", "GMD", "Africa/Banjul"], "georgia": ["Tbilisi", "GEL", "Asia/Tbilisi"],
            "germany": ["Berlin", "EUR", "Europe/Berlin"], "ghana": ["Accra", "GHS", "Africa/Accra"], "greece": ["Athens", "EUR", "Europe/Athens"],
            "greenland": ["Nuuk", "DKK", "America/Nuuk"], "grenada": ["St. George's", "XCD", "America/Grenada"], "guatemala": ["Guatemala City", "GTQ", "America/Guatemala"],
            "guinea": ["Conakry", "GNF", "Africa/Conakry"], "guyana": ["Georgetown", "GYD", "America/Guyana"], "haiti": ["Port-au-Prince", "HTG", "America/Port-au-Prince"],
            "honduras": ["Tegucigalpa", "HNL", "America/Tegucigalpa"], "hungary": ["Budapest", "HUF", "Europe/Budapest"], "iceland": ["Reykjavik", "ISK", "Atlantic/Reykjavik"],
            "india": ["New Delhi", "INR", "Asia/Kolkata"], "indonesia": ["Jakarta", "IDR", "Asia/Jakarta"], "iran": ["Tehran", "IRR", "Asia/Tehran"],
            "iraq": ["Baghdad", "IQD", "Asia/Baghdad"], "ireland": ["Dublin", "EUR", "Europe/Dublin"], "israel": ["Jerusalem", "ILS", "Asia/Jerusalem"],
            "italy": ["Rome", "EUR", "Europe/Rome"], "jamaica": ["Kingston", "JMD", "America/Jamaica"], "japan": ["Tokyo", "JPY", "Asia/Tokyo"],
            "jordan": ["Amman", "JOD", "Asia/Amman"], "kazakhstan": ["Astana", "KZT", "Asia/Almaty"], "kenya": ["Nairobi", "KES", "Africa/Nairobi"],
            "kuwait": ["Kuwait City", "KWD", "Asia/Kuwait"], "kyrgyzstan": ["Bishkek", "KGS", "Asia/Bishkek"], "laos": ["Vientiane", "LAK", "Asia/Vientiane"],
            "latvia": ["Riga", "EUR", "Europe/Riga"], "lebanon": ["Beirut", "LBP", "Asia/Beirut"], "lesotho": ["Maseru", "LSL", "Africa/Maseru"],
            "liberia": ["Monrovia", "LRD", "Africa/Monrovia"], "libya": ["Tripoli", "LYD", "Africa/Tripoli"], "liechtenstein": ["Vaduz", "CHF", "Europe/Vaduz"],
            "lithuania": ["Vilnius", "EUR", "Europe/Vilnius"], "luxembourg": ["Luxembourg", "EUR", "Europe/Luxembourg"], "madagascar": ["Antananarivo", "MGA", "Africa/Nairobi"],
            "malaysia": ["Kuala Lumpur", "MYR", "Asia/Kuala_Lumpur"], "maldives": ["Male", "MVR", "Indian/Maldives"], "mali": ["Bamako", "XOF", "Africa/Bamako"],
            "malta": ["Valletta", "EUR", "Europe/Malta"], "mexico": ["Mexico City", "MXN", "America/Mexico_City"], "moldova": ["Chisinau", "MDL", "Europe/Chisinau"],
            "monaco": ["Monaco", "EUR", "Europe/Monaco"], "mongolia": ["Ulaanbaatar", "MNT", "Asia/Ulaanbaatar"], "morocco": ["Rabat", "MAD", "Africa/Casablanca"],
            "nepal": ["Kathmandu", "NPR", "Asia/Kathmandu"], "netherlands": ["Amsterdam", "EUR", "Europe/Amsterdam"], "new zealand": ["Wellington", "NZD", "Pacific/Auckland"],
            "nigeria": ["Abuja", "NGN", "Africa/Lagos"], "north korea": ["Pyongyang", "KPW", "Asia/Pyongyang"], "norway": ["Oslo", "NOK", "Europe/Oslo"],
            "oman": ["Muscat", "OMR", "Asia/Muscat"], "pakistan": ["Islamabad", "PKR", "Asia/Karachi"], "panama": ["Panama City", "PAB", "America/Panama"],
            "paraguay": ["Asuncion", "PYG", "America/Asuncion"], "peru": ["Lima", "PEN", "America/Lima"], "philippines": ["Manila", "PHP", "Asia/Manila"],
            "poland": ["Warsaw", "PLN", "Europe/Warsaw"], "portugal": ["Lisbon", "EUR", "Europe/Lisbon"], "qatar": ["Doha", "QAR", "Asia/Qatar"],
            "romania": ["Bucharest", "RON", "Europe/Bucharest"], "russia": ["Moscow", "RUB", "Europe/Moscow"], "rwanda": ["Kigali", "RWF", "Africa/Kigali"],
            "saudi arabia": ["Riyadh", "SAR", "Asia/Riyadh"], "senegal": ["Dakar", "XOF", "Africa/Dakar"], "serbia": ["Belgrade", "RSD", "Europe/Belgrade"],
            "singapore": ["Singapore", "SGD", "Asia/Singapore"], "slovakia": ["Bratislava", "EUR", "Europe/Bratislava"], "slovenia": ["Ljubljana", "EUR", "Europe/Ljubljana"],
            "somalia": ["Mogadishu", "SOS", "Africa/Mogadishu"], "south africa": ["Pretoria", "ZAR", "Africa/Johannesburg"], "south korea": ["Seoul", "KRW", "Asia/Seoul"],
            "spain": ["Madrid", "EUR", "Europe/Madrid"], "sri lanka": ["Colombo", "LKR", "Asia/Colombo"], "sudan": ["Khartoum", "SDG", "Africa/Khartoum"],
            "sweden": ["Stockholm", "SEK", "Europe/Stockholm"], "switzerland": ["Bern", "CHF", "Europe/Zurich"], "syria": ["Damascus", "SYP", "Asia/Damascus"],
            "taiwan": ["Taipei", "TWD", "Asia/Taipei"], "tajikistan": ["Dushanbe", "TJS", "Asia/Dushanbe"], "tanzania": ["Dodoma", "TZS", "Africa/Dar_es_Salaam"],
            "thailand": ["Bangkok", "THB", "Asia/Bangkok"], "tunisia": ["Tunis", "TND", "Africa/Tunis"], "turkey": ["Ankara", "TRY", "Europe/Istanbul"],
            "turkmenistan": ["Ashgabat", "TMT", "Asia/Ashgabat"], "uganda": ["Kampala", "UGX", "Africa/Kampala"], "ukraine": ["Kyiv", "UAH", "Europe/Kyiv"],
            "uae": ["Abu Dhabi", "AED", "Asia/Dubai"], "uk": ["London", "GBP", "Europe/London"], "usa": ["Washington D.C.", "USD", "America/New_York"],
            "uruguay": ["Montevideo", "UYU", "America/Montevideo"], "uzbekistan": ["Tashkent", "UZS", "Asia/Tashkent"], "vatican": ["Vatican City", "EUR", "Europe/Vatican"],
            "venezuela": ["Caracas", "VES", "America/Caracas"], "vietnam": ["Hanoi", "VND", "Asia/Ho_Chi_Minh"], "yemen": ["Sanaa", "YER", "Asia/Aden"],
            "zambia": ["Lusaka", "ZMW", "Africa/Lusaka"], "zimbabwe": ["Harare", "ZWL", "Africa/Harare"]
        },
        codeSnippets: {
            python: "```python\n# Python Example\ndef greet(name):\n    return f'Hello, {name}!'\n\nfor i in range(5):\n    print(greet('User'))\n```",
            js: "```javascript\n// JavaScript Logic\nconst users = ['Alice', 'Bob'];\nusers.forEach(user => {\n    console.log(`Hello ${user}`);\n});\n```",
            html: "```html\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Test</title>\n</head>\n<body>\n  <h1>Hello World</h1>\n</body>\n</html>\n```",
            cpp: "```cpp\n#include <iostream>\nusing namespace std;\n\nint main() {\n    cout << \"Hello World\";\n    return 0;\n}\n```",
            css: "```css\nbody {\n  background: #f0f0f0;\n  font-family: sans-serif;\n}\n.card {\n  padding: 20px;\n  border-radius: 8px;\n}\n```"
        }
    },

    process(q) {
        let l = q.toLowerCase();

        // 1. GREETINGS & PERSONALITY
        if (l.match(/^(hi|hello|hey|yo|hola|greetings)$/)) return `Hello! I am **Askme Infinity**. Ready to calculate, code, or locate. What's on your mind?`;
        if (l.includes("who are you")) return "I am the **Infinity Core**, a localized intelligence capable of math, logic, and global data without needing the cloud.";

        // 2. CODING DEMANDS
        if (l.includes("code") || l.includes("program") || l.includes("snippet") || l.includes("function")) {
            if (l.includes("python")) return `### üêç Python Snippet\nHere is the code you requested:\n${this.db.codeSnippets.python}`;
            if (l.includes("javascript") || l.includes("js")) return `### üìú JavaScript Snippet\nHere is the logic:\n${this.db.codeSnippets.js}`;
            if (l.includes("html")) return `### üåê HTML Template\nStandard structure:\n${this.db.codeSnippets.html}`;
            if (l.includes("c++") || l.includes("cpp")) return `### ‚öôÔ∏è C++ Structure\nBasic main function:\n${this.db.codeSnippets.cpp}`;
            if (l.includes("css")) return `### üé® CSS Style\nBasic styling:\n${this.db.codeSnippets.css}`;
            return "### üíª Code Engine\nI support Python, JS, HTML, C++, and CSS. Specify a language! Example: `Write python code`.";
        }

        // 3. ADVANCED MATH (Includes %)
        try {
            // Replace text tokens with Math object and handle %
            let m = l.replace(/sin/g, 'Math.sin').replace(/cos/g, 'Math.cos').replace(/tan/g, 'Math.tan')
                     .replace(/log/g, 'Math.log10').replace(/ln/g, 'Math.log').replace(/sqrt/g, 'Math.sqrt')
                     .replace(/pie|pi/g, Math.PI).replace(/\^/g, '**');

            // Allow digits, math ops, and %
            if (/[0-9]/.test(m) && /Math\.|[+\-*/%]/.test(m)) {
                // Evaluator (Safe enough for local logic)
                // Note: JS uses % as modulo. 10 % 3 = 1.
                let res = eval(m.replace(/[^-()\d/*+.Mathlogsinctan%]/g, ''));
                if (!isNaN(res)) return `### üî¢ Math Core\n**Input:** \`${q}\`\n**Result:** \`${res.toLocaleString()}\``;
            }
        } catch(e){}

        // 4. GLOBAL GEO DATA (210 COUNTRIES)
        for (let k in this.db.countries) {
            if (l.includes(k)) {
                const [cap, cur, tz] = this.db.countries[k];
                // Time Query
                if (l.includes('time')) {
                    try {
                        const t = new Date().toLocaleTimeString('en-US', { timeZone: tz, hour: '2-digit', minute: '2-digit' });
                        return `### üïí World Clock\n**Location:** ${k.charAt(0).toUpperCase() + k.slice(1)}\n**Time:** ${t}\n**Zone:** ${tz}`;
                    } catch (e) { return "Timezone data unavailable offline for this specific region."; }
                }
                // General Info
                return `### üåç Geo Intelligence\n**Country:** ${k.toUpperCase()}\n**Capital:** ${cap}\n**Currency:** ${cur}\n**Region:** ${tz}`;
            }
        }

        return "My offline core requires specific keywords. Try asking about **'Time in Slovakia'**, **'Python code'**, or **'50 % 12'**.";
    }
};

const App = {
    async run() {
        const inp = document.getElementById('query');
        const q = inp.value.trim(); if(!q) return;
        const online = document.getElementById('mode').checked;
        
        inp.value = ""; UI.hideHero(); UI.addMessage(q, 'user');
        const lid = UI.addLoader();

        // 1. Try Online AI First
        if (online && navigator.onLine) {
            try {
                const res = await puter.ai.chat(q);
                UI.removeLoader(lid); UI.addMessage(res.toString(), 'ai'); return;
            } catch(e) {}
        }
        
        // 2. Fallback to Local Infinity Core
        setTimeout(() => { 
            UI.removeLoader(lid); 
            UI.addMessage(LogicCore.process(q), 'ai'); 
        }, 600);
    },

    handleFile(input) {
        const file = input.files[0]; if(!file) return;
        UI.hideHero(); UI.addMessage(`File: **${file.name}**`, 'user');
        const lid = UI.addLoader();
        setTimeout(() => {
            UI.removeLoader(lid);
            UI.addMessage(`**System Analysis:**\nFile \`${file.name}\` (${(file.size/1024).toFixed(1)} KB) received.\nType: ${file.type || 'Unknown'}.\n\n*My offline core cannot read contents, but I am aware of this file.*`, 'ai');
        }, 1000);
    }
};

class UI {
    static toggleMenu() { 
        document.getElementById('sidebar').classList.toggle('-translate-x-full'); 
        document.getElementById('overlay').classList.toggle('hidden'); 
    }
    static hideHero() { document.getElementById('hero')?.classList.add('hidden'); }
    static fill(t) { document.getElementById('query').value = t; App.run(); }
    static scroll() { const c = document.getElementById('chat-container'); c.scrollTop = c.scrollHeight; }
    
    static newChat() {
        document.getElementById('messages').innerHTML = "";
        document.getElementById('hero')?.classList.remove('hidden');
        if (window.innerWidth < 768) {
            document.getElementById('sidebar').classList.add('-translate-x-full');
            document.getElementById('overlay').classList.add('hidden');
        }
    }

    static addMessage(text, role) {
        const div = document.createElement('div');
        div.className = role === 'user' ? "msg-user" : "msg-ai";
        div.innerHTML = role === 'user' ? text : `<div class="ai-icon"></div><div class="prose text-[15px] flex-1 text-gray-800">${marked.parse(text)}</div>`;
        document.getElementById('messages').appendChild(div);
        this.scroll();
    }

    static addLoader() {
        const id = 'ld-' + Date.now();
        const div = document.createElement('div'); div.id = id; div.className = "msg-ai animate-pulse";
        div.innerHTML = `<div class="ai-icon bg-gray-200"></div><div class="flex flex-col gap-2 w-full mt-2"><div class="h-3 bg-gray-100 rounded w-1/4"></div><div class="h-3 bg-gray-100 rounded w-1/3"></div></div>`;
        document.getElementById('messages').appendChild(div);
        this.scroll(); return id;
    }
    static removeLoader(id) { document.getElementById(id)?.remove(); }
}
</script>
</body>
</html>
